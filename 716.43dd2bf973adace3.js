"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[716],{716(B,j,h){h.d(j,{SettingsPageModule:()=>w});var R=h(2200),f=h(4341),C=h(7343),_=h(8132),d=h(467),l=h(396),e=h(3664),g=h(2615),F=h(6321);let T=(()=>{var a;class s{constructor(t){this.cardsService=t}sanitize(t){return t.replace(/[^a-zA-Z]/g,"").toLowerCase()}hash(t){var n=this;return(0,d.A)(function*(){const o=n.sanitize(t),i=(new TextEncoder).encode(o),r=yield crypto.subtle.digest("SHA-256",i),m=new Uint8Array(r);return Array.from(m).map(c=>c.toString(16).padStart(2,"0")).join("")})()}submit(t){var n=this;return(0,d.A)(function*(){const o=yield n.hash(t);if(console.log("Cheat code hash:",o),"6a355f7a5c7b4dec7cbcda1296aa808d5d550f1d4da8453e9138e9aa10745544"===o){const i=n.cardsService.bulkSetStage(0,9,10);return console.log(`Cheat applied: ${i} cards set to stage 10`),!0}if("7e98e6735eef295f92bb1492228a48724b1d9b1b8bde969c3b7ee33cd38ebc7e"===o){const i=n.cardsService.clearFutureUnlocks();return console.log(`Cheat applied: ${i} cards unlocked immediately`),!0}return!1})()}static#e=a=()=>(this.\u0275fac=function(n){return new(n||s)(g.KVO(F.D))},this.\u0275prov=g.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}))}return a(),s})();const y=(a,s)=>s.id;function P(a,s){if(1&a&&(e.j41(0,"ion-select-option",6),e.EFF(1),e.k0s()),2&a){const u=s.$implicit;e.Y8G("value",u.id),e.R7$(),e.JRh(u.name)}}function $(a,s){if(1&a){const u=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-toggle",10),e.bIt("ionChange",function(n){const o=g.eBV(u).$implicit,i=e.XpG();return g.Njj(i.togglePauseDeck(o,n))}),e.k0s()()}if(2&a){const u=s.$implicit,t=e.XpG();e.R7$(2),e.JRh(u.label),e.R7$(),e.Y8G("checked",t.pausedDecks[u.id])}}function E(a,s){if(1&a){const u=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-button",11),e.bIt("click",function(){const n=g.eBV(u).$implicit,o=e.XpG();return g.Njj(o.resetCategory(n))}),e.EFF(4," Reset "),e.k0s()()}if(2&a){const u=s.$implicit;e.R7$(2),e.JRh(u.label)}}let v=(()=>{var a;class s{constructor(t,n,o){this.cardsService=t,this.cheatCodesService=n,this.alertCtrl=o,this.categories=[{id:"hiragana",label:"Hiragana"},{id:"katakana",label:"Katakana"},{id:"genki",label:"Genki Vocabulary"},{id:"wanikani",label:"WaniKani Lessons"},{id:"joyo-kanji",label:"J\u014dy\u014d Kanji"},{id:"jinmeiyo-kanji",label:"Jinmeiy\u014d Kanji"},{id:"hyogai-kanji",label:"Hy\u014dgai Kanji"},{id:"common-katakana-words",label:"Common Katakana Words"}],this.pausedDecks={},this.cheatCode="",this.selectedTheme="simple-dark",this.workbookThemes=[]}ngOnInit(){var t=this;return(0,d.A)(function*(){yield t.cardsService.initialize(),t.loadPauseStates(),t.workbookThemes=t.cardsService.getWorkbookThemes(),t.selectedTheme=t.cardsService.getWorkbookTheme()})()}loadPauseStates(){for(const t of this.categories)this.pausedDecks[t.id]=this.cardsService.isCategoryHidden(t.id)}onThemeChange(t){this.selectedTheme=t.detail.value,this.cardsService.setWorkbookTheme(this.selectedTheme)}togglePauseDeck(t,n){const o=n.detail.checked;this.cardsService.setCategoryHidden(t.id,o),this.pausedDecks[t.id]=o}resetCategory(t){var n=this;return(0,d.A)(function*(){var i;yield(yield n.alertCtrl.create({header:"Reset Progression",message:`Are you sure you would like to reset your progression on ${t.label}? This is IRREVERSIBLE!`,buttons:[{text:"Cancel",role:"cancel"},{text:"Reset",role:"destructive",handler:(i=(0,d.A)(function*(){yield n.cardsService.resetCategory(t.id)}),function(){return i.apply(this,arguments)})}]})).present()})()}submitCheatCode(){var t=this;return(0,d.A)(function*(){if(!t.cheatCode)return;const n=yield t.cheatCodesService.submit(t.cheatCode);t.cheatCode="",n||(yield(yield t.alertCtrl.create({header:"Invalid Code",message:"That code was not recognized.",buttons:["OK"]})).present())})()}backupData(){var t=this;return(0,d.A)(function*(){const n=yield t.cardsService.exportToBundle(),o=JSON.stringify(n),i=new Blob([o],{type:"application/json"}),r=URL.createObjectURL(i),b=`mojidoodle-backup-${(new Date).toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,p=document.createElement("a");p.href=r,p.download=b,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(r)})()}restoreData(){var t=this;return(0,d.A)(function*(){const n=document.createElement("input");n.type="file",n.accept=".json,application/json",n.onchange=function(){var o=(0,d.A)(function*(i){const r=i.target.files?.[0];if(r)try{const m=yield r.text(),c=JSON.parse(m),b=c.cards?.filter(k=>k.stage>=0)??[],p=c.lessons?.filter(k=>"locked"!==k.status)??[];console.log("Backup contains:",{totalCards:c.cards?.length??0,cardsWithProgress:b.length,totalLessons:c.lessons?.length??0,lessonsUnlocked:p.length,sampleCard:b[0],sampleLesson:p[0]}),yield(yield t.alertCtrl.create({header:"Restore Progress",message:"This will overwrite your current progress with the backup. Continue?",buttons:[{text:"Cancel",role:"cancel"},{text:"Restore",handler:(k=(0,d.A)(function*(){const S=yield t.cardsService.restoreFromBundle(c);yield t.showRestoreResult(S)}),function(){return k.apply(this,arguments)})}]})).present()}catch{yield(yield t.alertCtrl.create({header:"Error",message:"Failed to read backup file. Make sure it is a valid JSON file.",buttons:["OK"]})).present()}var k});return function(i){return o.apply(this,arguments)}}(),n.click()})()}showRestoreResult(t){var n=this;return(0,d.A)(function*(){let i=`${t.cardsUpdated} cards, ${t.lessonsUpdated} lessons updated`,r="";if(t.cardsNotFound+t.lessonsNotFound>0){const c=[];t.cardsNotFound>0&&c.push(`${t.cardsNotFound} cards`),t.lessonsNotFound>0&&c.push(`${t.lessonsNotFound} lessons`),r=`Not found in current database: ${c.join(", ")}`}yield(yield n.alertCtrl.create({header:"Restore Complete",subHeader:i,message:r||void 0,buttons:["OK"]})).present()})()}static#e=a=()=>(this.\u0275fac=function(n){return new(n||s)(e.rXU(F.D),e.rXU(T),e.rXU(C.hG))},this.\u0275cmp=e.VBU({type:s,selectors:[["app-settings"]],decls:59,vars:5,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["label","Workbook","interface","popover",3,"ionChange","value"],[3,"value"],["slot","end",3,"click"],["placeholder","Enter code...",3,"ngModelChange","keyup.enter","ngModel"],["slot","end",3,"click","disabled"],["slot","end",3,"ionChange","checked"],["slot","end","color","danger",3,"click"]],template:function(n,o){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Settings"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Settings"),e.k0s()()(),e.j41(11,"ion-list")(12,"ion-list-header")(13,"ion-label"),e.EFF(14,"Themes"),e.k0s()(),e.j41(15,"ion-item")(16,"ion-select",5),e.bIt("ionChange",function(r){return o.onThemeChange(r)}),e.Z7z(17,P,2,2,"ion-select-option",6,y),e.k0s()()(),e.j41(19,"ion-list")(20,"ion-list-header")(21,"ion-label"),e.EFF(22,"Data"),e.k0s()(),e.j41(23,"ion-item")(24,"ion-label")(25,"h2"),e.EFF(26,"Backup Progress"),e.k0s(),e.j41(27,"p"),e.EFF(28,"Download your progress as a JSON file"),e.k0s()(),e.j41(29,"ion-button",7),e.bIt("click",function(){return o.backupData()}),e.EFF(30," Backup "),e.k0s()(),e.j41(31,"ion-item")(32,"ion-label")(33,"h2"),e.EFF(34,"Restore Progress"),e.k0s(),e.j41(35,"p"),e.EFF(36,"Load progress from a backup file"),e.k0s()(),e.j41(37,"ion-button",7),e.bIt("click",function(){return o.restoreData()}),e.EFF(38," Restore "),e.k0s()()(),e.j41(39,"ion-list")(40,"ion-list-header")(41,"ion-label"),e.EFF(42,"Pause Decks"),e.k0s()(),e.Z7z(43,$,4,2,"ion-item",null,y),e.k0s(),e.j41(45,"ion-list")(46,"ion-list-header")(47,"ion-label"),e.EFF(48,"Reset Progression"),e.k0s()(),e.Z7z(49,E,5,1,"ion-item",null,y),e.k0s(),e.j41(51,"ion-list")(52,"ion-list-header")(53,"ion-label"),e.EFF(54,"Cheat Codes"),e.k0s()(),e.j41(55,"ion-item")(56,"ion-input",8),e.mxI("ngModelChange",function(r){return e.DH7(o.cheatCode,r)||(o.cheatCode=r),r}),e.bIt("keyup.enter",function(){return o.submitCheatCode()}),e.k0s(),e.j41(57,"ion-button",9),e.bIt("click",function(){return o.submitCheatCode()}),e.EFF(58," Submit "),e.k0s()()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(10),e.Y8G("value",o.selectedTheme),e.R7$(),e.Dyx(o.workbookThemes),e.R7$(26),e.Dyx(o.categories),e.R7$(6),e.Dyx(o.categories),e.R7$(7),e.R50("ngModel",o.cheatCode),e.R7$(),e.Y8G("disabled",!o.cheatCode))},dependencies:[l.eU,l.ai,l.BC,l.W9,l.QW,l.MC,l.nf,l.AF,l.he,l.uz,l.Jm,l.BY,l.$w,l.Nm,l.Ip,f.YN,f.BC,f.vS],encapsulation:2}))}return a(),s})();const D=[{path:"",component:v}];let A=(()=>{var a;class s{static#e=a=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=g.G2t({imports:[_.iI.forChild(D),_.iI]}))}return a(),s})(),w=(()=>{var a;class s{static#e=a=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=g.G2t({imports:[R.MD,f.YN,C.bv,A,v]}))}return a(),s})()}}]);