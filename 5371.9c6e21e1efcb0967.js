"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5371],{5371(N,v,l){l.d(v,{SettingsPageModule:()=>B});var R=l(2200),C=l(4341),b=l(7343),y=l(8132),p=l(467),a=l(6299),e=l(3664),h=l(2615),S=l(4185);const E=(o,s)=>s.id;function P(o,s){if(1&o){const k=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-button",6),e.bIt("click",function(){const n=h.eBV(k).$implicit,r=e.XpG();return h.Njj(r.resetCategory(n))}),e.EFF(4," Reset "),e.k0s()()}if(2&o){const k=s.$implicit;e.R7$(2),e.JRh(k.label)}}let F=(()=>{var o;class s{constructor(t,n){this.cardsService=t,this.alertCtrl=n,this.categories=[{id:"hiragana",label:"Hiragana"},{id:"katakana",label:"Katakana"},{id:"genki",label:"Genki Vocabulary"},{id:"wanikani",label:"WaniKani Lessons"},{id:"joyo-kanji",label:"J\u014dy\u014d Kanji"},{id:"jinmeiyo-kanji",label:"Jinmeiy\u014d Kanji"},{id:"common-katakana-words",label:"Common Katakana Words"}]}ngOnInit(){}resetCategory(t){var n=this;return(0,p.A)(function*(){var c;yield(yield n.alertCtrl.create({header:"Reset Progression",message:`Are you sure you would like to reset your progression on ${t.label}? This is IRREVERSIBLE!`,buttons:[{text:"Cancel",role:"cancel"},{text:"Reset",role:"destructive",handler:(c=(0,p.A)(function*(){yield n.cardsService.resetCategory(t.id)}),function(){return c.apply(this,arguments)})}]})).present()})()}backupData(){var t=this;return(0,p.A)(function*(){const n=yield t.cardsService.exportToBundle(),r=JSON.stringify(n),c=new Blob([r],{type:"application/json"}),d=URL.createObjectURL(c),f=`mojidoodle-backup-${(new Date).toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,u=document.createElement("a");u.href=d,u.download=f,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(d)})()}restoreData(){var t=this;return(0,p.A)(function*(){const n=document.createElement("input");n.type="file",n.accept=".json,application/json",n.onchange=function(){var r=(0,p.A)(function*(c){const d=c.target.files?.[0];if(d)try{const m=yield d.text(),i=JSON.parse(m),f=i.cards?.filter(g=>g.stage>=0)??[],u=i.lessons?.filter(g=>"locked"!==g.status)??[];console.log("Backup contains:",{totalCards:i.cards?.length??0,cardsWithProgress:f.length,totalLessons:i.lessons?.length??0,lessonsUnlocked:u.length,sampleCard:f[0],sampleLesson:u[0]}),yield(yield t.alertCtrl.create({header:"Restore Progress",message:"This will overwrite your current progress with the backup. Continue?",buttons:[{text:"Cancel",role:"cancel"},{text:"Restore",handler:(g=(0,p.A)(function*(){const j=yield t.cardsService.restoreFromBundle(i);yield t.showRestoreResult(j)}),function(){return g.apply(this,arguments)})}]})).present()}catch{yield(yield t.alertCtrl.create({header:"Error",message:"Failed to read backup file. Make sure it is a valid JSON file.",buttons:["OK"]})).present()}var g});return function(c){return r.apply(this,arguments)}}(),n.click()})()}showRestoreResult(t){var n=this;return(0,p.A)(function*(){let c=`${t.cardsUpdated} cards, ${t.lessonsUpdated} lessons updated`,d="";if(t.cardsNotFound+t.lessonsNotFound>0){const i=[];t.cardsNotFound>0&&i.push(`${t.cardsNotFound} cards`),t.lessonsNotFound>0&&i.push(`${t.lessonsNotFound} lessons`),d=`Not found in current database: ${i.join(", ")}`}yield(yield n.alertCtrl.create({header:"Restore Complete",subHeader:c,message:d||void 0,buttons:["OK"]})).present()})()}static#e=o=()=>(this.\u0275fac=function(n){return new(n||s)(e.rXU(S.D),e.rXU(b.hG))},this.\u0275cmp=e.VBU({type:s,selectors:[["app-settings"]],decls:37,vars:2,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["slot","end",3,"click"],["slot","end","color","danger",3,"click"]],template:function(n,r){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Settings"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Settings"),e.k0s()()(),e.j41(11,"ion-list")(12,"ion-list-header")(13,"ion-label"),e.EFF(14,"Data"),e.k0s()(),e.j41(15,"ion-item")(16,"ion-label")(17,"h2"),e.EFF(18,"Backup Progress"),e.k0s(),e.j41(19,"p"),e.EFF(20,"Download your progress as a JSON file"),e.k0s()(),e.j41(21,"ion-button",5),e.bIt("click",function(){return r.backupData()}),e.EFF(22," Backup "),e.k0s()(),e.j41(23,"ion-item")(24,"ion-label")(25,"h2"),e.EFF(26,"Restore Progress"),e.k0s(),e.j41(27,"p"),e.EFF(28,"Load progress from a backup file"),e.k0s()(),e.j41(29,"ion-button",5),e.bIt("click",function(){return r.restoreData()}),e.EFF(30," Restore "),e.k0s()()(),e.j41(31,"ion-list")(32,"ion-list-header")(33,"ion-label"),e.EFF(34,"Reset Progression"),e.k0s()(),e.Z7z(35,P,5,1,"ion-item",null,E),e.k0s()()),2&n&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(29),e.Dyx(r.categories))},dependencies:[a.eU,a.ai,a.BC,a.W9,a.QW,a.MC,a.nf,a.AF,a.he,a.uz,a.Jm],encapsulation:2}))}return o(),s})();const $=[{path:"",component:F}];let A=(()=>{var o;class s{static#e=o=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=h.G2t({imports:[y.iI.forChild($),y.iI]}))}return o(),s})(),B=(()=>{var o;class s{static#e=o=()=>(this.\u0275fac=function(n){return new(n||s)},this.\u0275mod=e.$C({type:s}),this.\u0275inj=h.G2t({imports:[R.MD,C.YN,b.bv,A,F]}))}return o(),s})()}}]);