"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[716],{716(w,j,u){u.d(j,{SettingsPageModule:()=>T});var R=u(2200),k=u(4341),y=u(7343),C=u(8132),d=u(467),c=u(8517),e=u(3664),h=u(2615),F=u(4185);let P=(()=>{var a;class o{constructor(t){this.cardsService=t}sanitize(t){return t.replace(/[^a-zA-Z]/g,"").toLowerCase()}hash(t){var n=this;return(0,d.A)(function*(){const s=n.sanitize(t),i=(new TextEncoder).encode(s),r=yield crypto.subtle.digest("SHA-256",i),f=new Uint8Array(r);return Array.from(f).map(l=>l.toString(16).padStart(2,"0")).join("")})()}submit(t){var n=this;return(0,d.A)(function*(){const s=yield n.hash(t);if(console.log("Cheat code hash:",s),"6a355f7a5c7b4dec7cbcda1296aa808d5d550f1d4da8453e9138e9aa10745544"===s){const i=n.cardsService.bulkSetStage(0,9,10);return console.log(`Cheat applied: ${i} cards set to stage 10`),!0}if("7e98e6735eef295f92bb1492228a48724b1d9b1b8bde969c3b7ee33cd38ebc7e"===s){const i=n.cardsService.clearFutureUnlocks();return console.log(`Cheat applied: ${i} cards unlocked immediately`),!0}return!1})()}static#e=a=()=>(this.\u0275fac=function(n){return new(n||o)(h.KVO(F.D))},this.\u0275prov=h.jDH({token:o,factory:o.\u0275fac,providedIn:"root"}))}return a(),o})();const _=(a,o)=>o.id;function E(a,o){if(1&a){const g=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-toggle",8),e.bIt("ionChange",function(n){const s=h.eBV(g).$implicit,i=e.XpG();return h.Njj(i.togglePauseDeck(s,n))}),e.k0s()()}if(2&a){const g=o.$implicit,t=e.XpG();e.R7$(2),e.JRh(g.label),e.R7$(),e.Y8G("checked",t.pausedDecks[g.id])}}function $(a,o){if(1&a){const g=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"ion-button",9),e.bIt("click",function(){const n=h.eBV(g).$implicit,s=e.XpG();return h.Njj(s.resetCategory(n))}),e.EFF(4," Reset "),e.k0s()()}if(2&a){const g=o.$implicit;e.R7$(2),e.JRh(g.label)}}let v=(()=>{var a;class o{constructor(t,n,s){this.cardsService=t,this.cheatCodesService=n,this.alertCtrl=s,this.categories=[{id:"hiragana",label:"Hiragana"},{id:"katakana",label:"Katakana"},{id:"genki",label:"Genki Vocabulary"},{id:"wanikani",label:"WaniKani Lessons"},{id:"joyo-kanji",label:"J\u014dy\u014d Kanji"},{id:"jinmeiyo-kanji",label:"Jinmeiy\u014d Kanji"},{id:"common-katakana-words",label:"Common Katakana Words"}],this.pausedDecks={},this.cheatCode=""}ngOnInit(){var t=this;return(0,d.A)(function*(){yield t.cardsService.initialize(),t.loadPauseStates()})()}loadPauseStates(){for(const t of this.categories)this.pausedDecks[t.id]=this.cardsService.isCategoryHidden(t.id)}togglePauseDeck(t,n){const s=n.detail.checked;this.cardsService.setCategoryHidden(t.id,s),this.pausedDecks[t.id]=s}resetCategory(t){var n=this;return(0,d.A)(function*(){var i;yield(yield n.alertCtrl.create({header:"Reset Progression",message:`Are you sure you would like to reset your progression on ${t.label}? This is IRREVERSIBLE!`,buttons:[{text:"Cancel",role:"cancel"},{text:"Reset",role:"destructive",handler:(i=(0,d.A)(function*(){yield n.cardsService.resetCategory(t.id)}),function(){return i.apply(this,arguments)})}]})).present()})()}submitCheatCode(){var t=this;return(0,d.A)(function*(){if(!t.cheatCode)return;const n=yield t.cheatCodesService.submit(t.cheatCode);t.cheatCode="",n||(yield(yield t.alertCtrl.create({header:"Invalid Code",message:"That code was not recognized.",buttons:["OK"]})).present())})()}backupData(){var t=this;return(0,d.A)(function*(){const n=yield t.cardsService.exportToBundle(),s=JSON.stringify(n),i=new Blob([s],{type:"application/json"}),r=URL.createObjectURL(i),b=`mojidoodle-backup-${(new Date).toISOString().replace(/[:.]/g,"-").slice(0,19)}.json`,p=document.createElement("a");p.href=r,p.download=b,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(r)})()}restoreData(){var t=this;return(0,d.A)(function*(){const n=document.createElement("input");n.type="file",n.accept=".json,application/json",n.onchange=function(){var s=(0,d.A)(function*(i){const r=i.target.files?.[0];if(r)try{const f=yield r.text(),l=JSON.parse(f),b=l.cards?.filter(m=>m.stage>=0)??[],p=l.lessons?.filter(m=>"locked"!==m.status)??[];console.log("Backup contains:",{totalCards:l.cards?.length??0,cardsWithProgress:b.length,totalLessons:l.lessons?.length??0,lessonsUnlocked:p.length,sampleCard:b[0],sampleLesson:p[0]}),yield(yield t.alertCtrl.create({header:"Restore Progress",message:"This will overwrite your current progress with the backup. Continue?",buttons:[{text:"Cancel",role:"cancel"},{text:"Restore",handler:(m=(0,d.A)(function*(){const S=yield t.cardsService.restoreFromBundle(l);yield t.showRestoreResult(S)}),function(){return m.apply(this,arguments)})}]})).present()}catch{yield(yield t.alertCtrl.create({header:"Error",message:"Failed to read backup file. Make sure it is a valid JSON file.",buttons:["OK"]})).present()}var m});return function(i){return s.apply(this,arguments)}}(),n.click()})()}showRestoreResult(t){var n=this;return(0,d.A)(function*(){let i=`${t.cardsUpdated} cards, ${t.lessonsUpdated} lessons updated`,r="";if(t.cardsNotFound+t.lessonsNotFound>0){const l=[];t.cardsNotFound>0&&l.push(`${t.cardsNotFound} cards`),t.lessonsNotFound>0&&l.push(`${t.lessonsNotFound} lessons`),r=`Not found in current database: ${l.join(", ")}`}yield(yield n.alertCtrl.create({header:"Restore Complete",subHeader:i,message:r||void 0,buttons:["OK"]})).present()})()}static#e=a=()=>(this.\u0275fac=function(n){return new(n||o)(e.rXU(F.D),e.rXU(P),e.rXU(y.hG))},this.\u0275cmp=e.VBU({type:o,selectors:[["app-settings"]],decls:51,vars:4,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["slot","end",3,"click"],["placeholder","Enter code...",3,"ngModelChange","keyup.enter","ngModel"],["slot","end",3,"click","disabled"],["slot","end",3,"ionChange","checked"],["slot","end","color","danger",3,"click"]],template:function(n,s){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-menu-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Settings"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Settings"),e.k0s()()(),e.j41(11,"ion-list")(12,"ion-list-header")(13,"ion-label"),e.EFF(14,"Data"),e.k0s()(),e.j41(15,"ion-item")(16,"ion-label")(17,"h2"),e.EFF(18,"Backup Progress"),e.k0s(),e.j41(19,"p"),e.EFF(20,"Download your progress as a JSON file"),e.k0s()(),e.j41(21,"ion-button",5),e.bIt("click",function(){return s.backupData()}),e.EFF(22," Backup "),e.k0s()(),e.j41(23,"ion-item")(24,"ion-label")(25,"h2"),e.EFF(26,"Restore Progress"),e.k0s(),e.j41(27,"p"),e.EFF(28,"Load progress from a backup file"),e.k0s()(),e.j41(29,"ion-button",5),e.bIt("click",function(){return s.restoreData()}),e.EFF(30," Restore "),e.k0s()()(),e.j41(31,"ion-list")(32,"ion-list-header")(33,"ion-label"),e.EFF(34,"Pause Decks"),e.k0s()(),e.Z7z(35,E,4,2,"ion-item",null,_),e.k0s(),e.j41(37,"ion-list")(38,"ion-list-header")(39,"ion-label"),e.EFF(40,"Reset Progression"),e.k0s()(),e.Z7z(41,$,5,1,"ion-item",null,_),e.k0s(),e.j41(43,"ion-list")(44,"ion-list-header")(45,"ion-label"),e.EFF(46,"Cheat Codes"),e.k0s()(),e.j41(47,"ion-item")(48,"ion-input",6),e.mxI("ngModelChange",function(r){return e.DH7(s.cheatCode,r)||(s.cheatCode=r),r}),e.bIt("keyup.enter",function(){return s.submitCheatCode()}),e.k0s(),e.j41(49,"ion-button",7),e.bIt("click",function(){return s.submitCheatCode()}),e.EFF(50," Submit "),e.k0s()()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(29),e.Dyx(s.categories),e.R7$(6),e.Dyx(s.categories),e.R7$(7),e.R50("ngModel",s.cheatCode),e.R7$(),e.Y8G("disabled",!s.cheatCode))},dependencies:[c.eU,c.ai,c.BC,c.W9,c.QW,c.MC,c.nf,c.AF,c.he,c.uz,c.Jm,c.BY,c.$w,k.YN,k.BC,k.vS],encapsulation:2}))}return a(),o})();const A=[{path:"",component:v}];let D=(()=>{var a;class o{static#e=a=()=>(this.\u0275fac=function(n){return new(n||o)},this.\u0275mod=e.$C({type:o}),this.\u0275inj=h.G2t({imports:[C.iI.forChild(A),C.iI]}))}return a(),o})(),T=(()=>{var a;class o{static#e=a=()=>(this.\u0275fac=function(n){return new(n||o)},this.\u0275mod=e.$C({type:o}),this.\u0275inj=h.G2t({imports:[R.MD,k.YN,y.bv,D,v]}))}return a(),o})()}}]);