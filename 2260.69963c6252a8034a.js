"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2260],{2260(b,k,e){e.d(k,{WorkbookPageModule:()=>O});var h,f=e(2200),B=e(4341),L=e(7343),p=e(8132),r=e(8690),u=function(o,i){var l=function(){if(typeof window>"u")return new Map;if(!h){var o=window;o.Ionicons=o.Ionicons||{},h=o.Ionicons.map=o.Ionicons.map||new Map}return h}(),a=l.get(o);void 0===a?l.set(o,i):a!==i&&console.warn('[Ionicons Warning]: Multiple icons were mapped to name "'.concat(o,'". Ensure that multiple icons are not mapped to the same icon name.'))},n=e(3664),v=e(2615);const y=["canvas"];let z=(()=>{var o;class i{constructor(){this.isDrawing=!1,this.strokes=[],this.currentStroke=[],function(o){Object.keys(o).forEach(function(i){u(i,o[i]);var l=i.replace(/([a-z0-9]|(?=[A-Z]))([A-Z0-9])/g,"$1-$2").toLowerCase();i!==l&&u(l,o[i])})}({arrowUndo:"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' class='ionicon' viewBox='0 0 512 512'><path d='M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z'/></svg>"})}ngOnInit(){}ngAfterViewInit(){setTimeout(()=>this.setupCanvas(),100)}ngOnDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()}setupCanvas(){const a=this.canvasRef.nativeElement,s=a.parentElement;s&&(this.resizeCanvas(),this.resizeObserver=new ResizeObserver(()=>this.resizeCanvas()),this.resizeObserver.observe(s),this.ctx=a.getContext("2d"),this.setCanvasStyle(),a.addEventListener("mousedown",this.handleMouseDown.bind(this)),a.addEventListener("mousemove",this.handleMouseMove.bind(this)),a.addEventListener("mouseup",this.handleMouseUp.bind(this)),a.addEventListener("mouseleave",this.handleMouseUp.bind(this)),a.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),a.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),a.addEventListener("touchend",this.handleTouchEnd.bind(this)))}resizeCanvas(){const a=this.canvasRef.nativeElement,s=a.parentElement;s&&(a.width=s.clientWidth,a.height=s.clientHeight,this.ctx&&this.setCanvasStyle())}setCanvasStyle(){this.ctx.strokeStyle="#fff",this.ctx.lineWidth=4,this.ctx.lineCap="round",this.ctx.lineJoin="round"}handleMouseDown(a){this.isDrawing=!0;const s=this.getMousePos(a);this.currentStroke=[s],this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y)}handleMouseMove(a){if(!this.isDrawing)return;const s=this.getMousePos(a);this.currentStroke.push(s),this.ctx.lineTo(s.x,s.y),this.ctx.stroke()}handleMouseUp(){this.isDrawing&&this.currentStroke.length>0&&(this.strokes.push([...this.currentStroke]),this.currentStroke=[]),this.isDrawing=!1}handleTouchStart(a){a.preventDefault(),this.isDrawing=!0;const s=this.getTouchPos(a);this.currentStroke=[s],this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y)}handleTouchMove(a){if(!this.isDrawing)return;a.preventDefault();const s=this.getTouchPos(a);this.currentStroke.push(s),this.ctx.lineTo(s.x,s.y),this.ctx.stroke()}handleTouchEnd(){this.isDrawing&&this.currentStroke.length>0&&(this.strokes.push([...this.currentStroke]),this.currentStroke=[]),this.isDrawing=!1}getMousePos(a){const s=this.canvasRef.nativeElement,t=s.getBoundingClientRect();return{x:s.width/t.width*(a.clientX-t.left),y:s.height/t.height*(a.clientY-t.top)}}getTouchPos(a){const s=this.canvasRef.nativeElement,t=s.getBoundingClientRect();return{x:s.width/t.width*(a.touches[0].clientX-t.left),y:s.height/t.height*(a.touches[0].clientY-t.top)}}onCheck(){console.log("Check button pressed")}onUndo(){this.strokes.length>0&&(this.strokes.pop(),this.redrawStrokes())}redrawStrokes(){const a=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,a.width,a.height),this.setCanvasStyle();for(const s of this.strokes)if(!(s.length<2)){this.ctx.beginPath(),this.ctx.moveTo(s[0].x,s[0].y);for(let t=1;t<s.length;t++)this.ctx.lineTo(s[t].x,s[t].y);this.ctx.stroke()}}clearCanvas(){const a=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,a.width,a.height),this.strokes=[]}static#o=o=()=>(this.\u0275fac=function(s){return new(s||i)},this.\u0275cmp=n.VBU({type:i,selectors:[["app-workbook"]],viewQuery:function(s,t){if(1&s&&n.GBs(y,5),2&s){let c;n.mGM(c=n.lsd())&&(t.canvasRef=c.first)}},decls:12,vars:2,consts:[["canvas",""],[1,"workbook-content",3,"fullscreen","scrollY"],[1,"prompt-bar"],["color","light"],[1,"prompt-text"],[1,"canvas-wrapper"],[1,"drawing-canvas"],["fill","clear",1,"undo-btn",3,"click"],["name","arrow-undo"],[1,"check-btn",3,"click"]],template:function(s,t){if(1&s){const c=n.RV6();n.j41(0,"ion-content",1)(1,"div",2),n.nrm(2,"ion-menu-button",3),n.j41(3,"span",4),n.EFF(4,"A (Hiragana)"),n.k0s()(),n.j41(5,"div",5),n.nrm(6,"canvas",6,0),n.j41(8,"ion-button",7),n.bIt("click",function(){return v.eBV(c),v.Njj(t.onUndo())}),n.nrm(9,"ion-icon",8),n.k0s()(),n.j41(10,"ion-button",9),n.bIt("click",function(){return v.eBV(c),v.Njj(t.onCheck())}),n.EFF(11,"CHECK!"),n.k0s()()}2&s&&n.Y8G("fullscreen",!0)("scrollY",!1)},dependencies:[r.W9,r.MC,r.Jm,r.iq],styles:[".workbook-content[_ngcontent-%COMP%]{--background: #000}.prompt-bar[_ngcontent-%COMP%]{display:flex;align-items:center;height:48px;background:#111;padding:0 8px}.prompt-text[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:28px;color:#fff;margin-right:40px}.canvas-wrapper[_ngcontent-%COMP%]{position:absolute;inset:48px 0 0;background:#000}.drawing-canvas[_ngcontent-%COMP%]{width:100%;height:100%;touch-action:none;display:block}.undo-btn[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;--color: #666;--padding-start: 8px;--padding-end: 8px;font-size:24px}.check-btn[_ngcontent-%COMP%]{position:absolute;bottom:32px;left:50%;transform:translate(-50%);--background: #222;--background-hover: #333;--color: #fff;--border-radius: 32px;--padding-start: 12vw;--padding-end: 12vw;--padding-top: 16px;--padding-bottom: 16px;min-height:60px;font-size:clamp(20px,5vw,28px);font-weight:600;letter-spacing:2px}"]}))}return o(),i})();const S=[{path:"",component:z}];let j=(()=>{var o;class i{static#o=o=()=>(this.\u0275fac=function(s){return new(s||i)},this.\u0275mod=n.$C({type:i}),this.\u0275inj=v.G2t({imports:[p.iI.forChild(S),p.iI]}))}return o(),i})(),O=(()=>{var o;class i{static#o=o=()=>(this.\u0275fac=function(s){return new(s||i)},this.\u0275mod=n.$C({type:i}),this.\u0275inj=v.G2t({imports:[f.MD,B.YN,L.bv,j,z]}))}return o(),i})()}}]);