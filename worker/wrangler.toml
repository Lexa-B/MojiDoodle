name = "mojidoodle-collector"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Custom domain routes
routes = [
  { pattern = "data-collection.mojidoodle.ai/*", zone_name = "mojidoodle.ai" },
  { pattern = "mojidoodle.lexa.digital/*", zone_name = "lexa.digital" }
]

# KV namespace for rate limiting
[[kv_namespaces]]
binding = "RATE_LIMIT"
id = "d82e54e08d5241c28f6f4df86180f8ee"

# KV namespace for storing samples - fallback if R2 not configured
# (create with: wrangler kv:namespace create SAMPLES)
# [[kv_namespaces]]
# binding = "SAMPLES"
# id = "your-kv-namespace-id"

# R2 bucket for storage (create with: wrangler r2 bucket create mojidoodle-samples)
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "mojidoodle-samples"

[vars]
ALLOWED_ORIGINS = "https://lexa-b.github.io,https://app.mojidoodle.ai,https://dev.mojidoodle.ai"
